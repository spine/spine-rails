#= require json2
#= require jquery
#= require spine
#= require spine/manager
#= require spine/ajax
#= require spine/route
#= require spine/rails

#= require_self
#= require_tree ./models
#= require_tree ./controllers
#= require_tree ./views

class <%= app_class %> extends Spine.Controller
  constructor: ->
    super
    
    # Initialize controllers:
    #  @append(@items = new <%= app_class %>.Items)
    #  ...
    
    Spine.Route.setup()

window.<%= app_class %> = <%= app_class %>

# Helpers / shortcuts for controllers
Spine.Controller.include
  # instead of JST['app/views/posts/show'] just write
  # @view('posts/show') => function that generates HTML
  view: (name) -> JST["<%= app_name %>/views/#{name}"]

  # @renderView('posts/show', post) => html string
  renderView: (name, data) -> @view(name)(data)

  # @htmlFor('show', post) => html string
  htmlFor: (subViewName, data) ->
    protoString = @constructor.toString().match(/^function ([^\(]+)/)[1] # Blogs
    areaName = protoString.toLowerCase() # blogs
    @renderView "#{areaName}/#{subViewName}", data # @htmlFor "blogs/show", data
    
